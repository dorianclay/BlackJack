name: Deploy Web App

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup GCloud SDK
        uses: google-github-actions/setup-gcloud@v0.2.1
        with:
          
          # Service account email address to use for authentication. This is required
          # for legacy .p12 keys but can be omitted for .json keys. This is usually of
          # the format <name>@<project-id>.iam.gserviceaccount.com.
          service_account_email: ${{ secrets.SERVICE_ACCOUNT_EMAIL }} # optional
          
          # Service account key to use for authentication. This should be the JSON
          # formatted private key which can be exported from the Cloud Console. The
          # value can be raw or base64-encoded.
          service_account_key: ${{ secrets.SERVICE_ACCOUNT_KEY }} # optional
          
          # ID of the Google Cloud project. If provided, this will configure gcloud to
          # use this project ID by default for commands. Individual commands can still
          # override the project using the --project flag which takes precedence.
          project_id: ${{ secrets.PROJECT_ID }} # optional
          
          # Export the provided credentials as Google Default Application Credentials.
          # This will make the credentials available to later steps via the
          # GOOGLE_APPLICATION_CREDENTIALS environment variable. Future steps that
          # consume Default Application Credentials will automatically detect and use
          # these credentials.
          export_default_credentials: true # optional
      - name: Build Container
        run: gcloud builds submit --tag gcr.io/card-game-304718/api
